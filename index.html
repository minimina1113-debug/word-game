<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€£æ¥è©ç·´ç¿’ V4.0 (é€²åº¦æ¢å„ªåŒ–ç‰ˆ)</title>
    <style>
        /* --- 1. å­—é«”è¨­å®š --- */
        @font-face {
            font-family: 'TW-Sung';
            src: url('https://cdn.jsdelivr.net/gh/max32002/TW-Sung@2.128/TW-Sung-90ms.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        :root {
            --primary-color: #A9D18E; /* ç¶ è‰²ç³» */
            --accent-color: #6AA84F; /* æ·±ç¶ è‰² */
            --main-font: 'TW-Sung', "Microsoft JhengHei", sans-serif;
            --bg-color: #F6FFED;
        }

        body {
            font-family: var(--main-font);
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }

        /* å°è¦½åˆ— */
        .nav-bar {
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            background: white;
            padding: 8px 20px;
            border-radius: 50px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            z-index: 10;
        }

        .nav-btn {
            border: none;
            background: none;
            font-size: 1.1em;
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 30px;
            color: #888;
            font-weight: bold;
            transition: 0.3s;
        }

        .nav-btn.active {
            background-color: var(--accent-color);
            color: white;
        }

        /* å®¹å™¨è¨­å®š */
        .container {
            display: none;
            width: 90%;
            max-width: 600px;
            flex-direction: column;
            align-items: center;
        }

        .container.active {
            display: flex;
            animation: fadeIn 0.5s;
        }

        /* --- å­¸ç¿’æ¨¡å¼ --- */
        .linker-card { background: white; padding: 30px; width: 100%; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); box-sizing: border-box; }
        .linker-word { font-size: 2.5em; font-weight: bold; color: var(--accent-color); margin-bottom: 10px; text-align: center; border-bottom: 3px dashed var(--primary-color); padding-bottom: 10px; }
        .linker-meaning { font-size: 1.2em; color: #555; margin-bottom: 15px; line-height: 1.8; }
        .linker-example { background-color: #F0F9FF; padding: 15px; border-radius: 10px; font-style: italic; color: #333; }

        /* --- æ¸¬é©—æ¨¡å¼ (å¡«ç©º) --- */
        /* æ–°å¢ï¼šé€²åº¦é¡¯ç¤ºæ¨£å¼ */
        .progress-display {
            font-size: 1.1em;
            font-weight: bold;
            color: var(--accent-color);
            margin-bottom: 10px;
            width: 100%;
            text-align: center;
        }
        
        #quizContent { background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; box-sizing: border-box; }
        .quiz-question { font-size: 1.5em; margin-bottom: 25px; line-height: 2; text-align: center; color: #333; }
        .option-btn { background: #E8F5E9; border: 2px solid var(--primary-color); padding: 12px; border-radius: 12px; font-size: 1.1em; text-align: center; cursor: pointer; margin-bottom: 10px; width: 100%; box-sizing: border-box; transition: 0.2s; color: #333; font-weight: bold; }
        .option-btn:hover { background-color: var(--primary-color); }
        .option-btn.correct { background-color: #C8E6C9; border-color: #4CAF50; color: #2E7D32; }
        .option-btn.wrong { background-color: #FFCDD2; border-color: #F44336; color: #C62828; }
        .quiz-feedback { min-height: 30px; color: var(--accent-color); font-weight: bold; margin-top:15px; text-align: center; }
        .btn-main { padding: 10px 25px; font-size: 1.1em; border: none; border-radius: 50px; background-color: var(--accent-color); color: white; cursor: pointer; margin-top: 20px; }
        #quizSummary { display:none; text-align:center; padding: 30px; background: white; border-radius: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 100%; }
        .summary-score { font-size: 2.2em; color: var(--accent-color); font-weight: bold; }

    </style>
</head>
<body>

    <div class="nav-bar">
        <button class="nav-btn active" id="btnStudy" onclick="switchMode('study')">ğŸ“– ç”¨æ³•</button>
        <button class="nav-btn" id="btnQuiz" onclick="switchMode('quiz')">âœï¸ ç·´ç¿’</button>
    </div>

    <div id="studyContainer" class="container active">
        <select id="linkerSelector" onchange="jumpToLinker(this.value)" style="margin-bottom: 15px; padding: 10px; font-size: 1.1em; border-radius: 8px; border: 2px solid var(--accent-color);">
            </select>

        <div class="linker-card">
            <div class="linker-word" id="studyWord">è¼‰å…¥ä¸­...</div>
            <div class="linker-meaning" id="studyMeaning">è¼‰å…¥ä¸­...</div>
            <div class="linker-example" id="studyExample">è¼‰å…¥ä¸­...</div>
        </div>

        <div class="control-area">
            <button class="btn-main" style="background-color: #ccc;" onclick="prevLinker()">ä¸Šä¸€å€‹</button>
            <button class="btn-main" onclick="nextLinker()">ä¸‹ä¸€å€‹</button>
        </div>
    </div>

    <div id="quizContainer" class="container">
        
        <div class="progress-display" id="quizProgress"></div>
        
        <div id="quizSummary">
            <h2 style="color: var(--accent-color);">ç·´ç¿’çµæœ</h2>
            <p id="summaryText" class="summary-score"></p>
            <p style="font-size: 1.1em; color: #777; margin-bottom: 20px;">æ­å–œå®Œæˆä¸€è¼ªç·´ç¿’ï¼</p>
            <button class="btn-main" onclick="startNewQuizRound()">å†æ¸¬ä¸€æ¬¡</button>
        </div>

        <div id="quizContent">
            <div class="quiz-question" id="quizQuestion">è«‹é¸å‡ºæœ€é©åˆçš„é€£æ¥è©å¡«å…¥ç©ºæ ¼ä¸­ã€‚</div>
            <div id="quizOptions"></div>
            <div id="quizFeedback" class="quiz-feedback"></div>
            <button class="btn-main" onclick="nextQuiz()">ä¸‹ä¸€é¡Œ</button>
        </div>
    </div>

    <script>
        // --- 1. è³‡æ–™åº« (V3.0 è³‡æ–™åº«ï¼Œå…§å®¹ä¸è®Š) ---
        const linkerData = [
            { 
                word: "ä½†æ˜¯", 
                meaning: "è¡¨ç¤ºè½‰æŠ˜èªæ°£ï¼Œå¼•å°å‡ºèˆ‡å‰ä¸€å¥ç›¸åæˆ–ä¸åŒçš„æƒ…æ³ã€‚", 
                type: "è½‰æŠ˜",
                examples: [
                    "é›–ç„¶ä»Šå¤©å¤©æ°£æ™´æœ—ï¼Œ_____é¢¨å»å¾ˆå¤§ï¼Œä¸é©åˆåœ¨å¤–ä¹…ç•™ã€‚",
                    "æˆ‘ç­”æ‡‰å¹«ä»–é€™å€‹å¿™ï¼Œ_____æˆ‘å¸Œæœ›ä»–ä¸‹æ¬¡èƒ½è‡ªå·±è§£æ±ºå•é¡Œã€‚",
                    "é€™æ¬¾æ‰‹æ©ŸåŠŸèƒ½å¼·å¤§ï¼Œ_____åƒ¹æ ¼ä¸¦ä¸è¦ªæ°‘ã€‚"
                ]
            },
            { 
                word: "å¦‚æœ", 
                meaning: "è¡¨ç¤ºå‡è¨­é—œä¿‚ï¼Œé€šå¸¸èˆ‡ã€å°±ã€ã€ã€ä¾¿ã€ç­‰è©æ­é…ä½¿ç”¨ã€‚", 
                type: "å‡è¨­",
                examples: [
                    "_____ä½ æ˜å¤©æœ‰ç©ºï¼Œæˆ‘å€‘å°±ä¸€èµ·å»çœ‹é›»å½±ã€‚",
                    "_____èƒ½å†å¤šçµ¦æˆ‘ä¸€é»æ™‚é–“æº–å‚™ï¼Œæˆ‘ä¸€å®šæœƒåšå¾—æ›´å¥½ã€‚",
                    "_____æˆ‘å€‘ç¾åœ¨å‡ºç™¼ï¼Œæ‡‰è©²å‰›å¥½å¯ä»¥è¶•ä¸Šæ—¥å‡ºã€‚"
                ]
            },
            { 
                word: "é›–ç„¶", 
                meaning: "è¡¨ç¤ºè®“æ­¥æˆ–è¼•å¾®è½‰æŠ˜ï¼Œé€šå¸¸èˆ‡ã€ä½†æ˜¯ã€ã€ã€ä»ç„¶ã€ç­‰è©æ­é…ã€‚", 
                type: "è®“æ­¥è½‰æŠ˜",
                examples: [
                    "_____å¥¹å·²ç¶“å¾ˆåŠªåŠ›äº†ï¼Œçµæœå»ä»ç„¶ä¸ç›¡ç†æƒ³ã€‚",
                    "_____é€™æœ¬æ›¸æœ‰é»è²´ï¼Œä½†æ˜¯å…§å®¹éå¸¸å€¼å¾—ä¸€è®€ã€‚",
                    "_____æˆ‘å€‘è¼¸äº†æ¯”è³½ï¼Œä¸ééšŠå“¡å€‘çš„å£«æ°£ä¸¦æ²’æœ‰å› æ­¤ä½è½ã€‚"
                ]
            },
            { 
                word: "æ—¢ç„¶", 
                meaning: "è¡¨ç¤ºå‰ææˆ–åŸå› ï¼Œå¼•å°å‡ºåˆç†çš„çµæœæˆ–æ±ºå®šã€‚", 
                type: "å› æœ",
                examples: [
                    "ä½ _____å·²ç¶“æ±ºå®šå‡ºåœ‹ç•™å­¸ï¼Œå°±æ‡‰è©²å¥½å¥½è¦åŠƒæ¥ä¸‹ä¾†çš„è¡Œç¨‹ã€‚",
                    "_____å¤§å®¶æ„è¦‹éƒ½ä¸€è‡´ï¼Œæˆ‘å€‘å°±æŒ‰ç…§é€™å€‹æ–¹æ¡ˆåŸ·è¡Œå§ã€‚",
                    "_____ä½ å°é€™ä»¶äº‹æƒ…ä¸äº†è§£ï¼Œå°±è«‹ä¸è¦éš¨æ„ç™¼è¡¨è©•è«–ã€‚"
                ]
            },
            { 
                word: "ç«Ÿç„¶", 
                meaning: "è¡¨ç¤ºå‡ºä¹æ„æ–™æˆ–é©šè¨çš„èªæ°£ã€‚", 
                type: "é©šè¨",
                examples: [
                    "ä»–çœ‹èµ·ä¾†æ–‡éœæœ‰ç¦®ï¼Œæ²’æƒ³åˆ°ç§åº•ä¸‹_____æ˜¯ä¸€å€‹ç†±æ„›æ¥µé™é‹å‹•çš„é¸æ‰‹ã€‚",
                    "é€™é“æ•¸å­¸é¡Œçœ‹èµ·ä¾†å¾ˆç°¡å–®ï¼Œæˆ‘å˜—è©¦äº†å¥½å¹¾æ¬¡_____æ²’ç®—å‡ºä¾†ã€‚",
                    "æˆ‘å€‘éƒ½èªç‚ºä»–æœƒåå°ï¼Œçµæœä»–_____ç¬¬ä¸€å€‹è¡¨ç¤ºè´Šæˆã€‚"
                ]
            },
            { 
                word: "æˆ–è¨±", 
                meaning: "è¡¨ç¤ºä¸ç¢ºå®šæ€§æˆ–å¯èƒ½æ€§ã€‚", 
                type: "æ¨æ¸¬",
                examples: [
                    "ä»–é²åˆ°äº†é€™éº¼ä¹…ï¼Œ_____è·¯ä¸Šå‡ºäº†é»ç‹€æ³ï¼Œæˆ‘å€‘å†ç­‰ç­‰çœ‹å§ã€‚",
                    "é€™æ˜¯ä¸€å€‹å¾ˆé›£çš„æ±ºå®šï¼Œ_____æˆ‘å€‘å¯ä»¥å…ˆè½è½å…¶ä»–äººçš„æ„è¦‹ã€‚",
                    "åˆ¥å¤ªæ—©æ”¾æ£„ï¼Œé€™ä»¶äº‹_____é‚„æœ‰ä¸€ç·šè½‰æ©Ÿã€‚"
                ]
            },
            { 
                word: "ç„¶å¾Œ", 
                meaning: "è¡¨ç¤ºæ™‚é–“æˆ–æ­¥é©Ÿçš„é †åºã€‚", 
                type: "é †åº",
                examples: [
                    "æˆ‘å…ˆå»åœ–æ›¸é¤¨å€Ÿæ›¸ï¼Œ_____å›å®¶å®Œæˆä½œæ¥­ã€‚",
                    "æˆ‘å€‘è¨è«–äº†æ–¹æ¡ˆçš„ç´°ç¯€ï¼Œ_____é–‹å§‹åˆ†é…æ¯å€‹äººçš„ä»»å‹™ã€‚",
                    "å¥¹å…ˆå‘è€å¸«æå‡ºå•é¡Œï¼Œ_____å¾—åˆ°äº†è©³ç´°çš„è§£ç­”ã€‚"
                ]
            },
            { 
                word: "ä¸ç„¶", 
                meaning: "è¡¨ç¤ºå‡è¨­çš„å¦å®šæƒ…æ³ï¼Œå¼•å°å‡ºå¾Œæœæˆ–è­¦å‘Šï¼Œç›¸ç•¶æ–¼ã€å¦å‰‡ã€ã€‚", 
                type: "è­¦å‘Š",
                examples: [
                    "è«‹ä½ å‹•ä½œå¿«ä¸€é»ï¼Œ_____æˆ‘å€‘æœƒè¶•ä¸ä¸Šç«è»Šçš„ã€‚",
                    "ä½ å¿…é ˆéµå®ˆè¦å®šï¼Œ_____æœƒè¢«è™•ç½°ã€‚",
                    "è¨˜å¾—æŠŠé–€é–å¥½ï¼Œ_____å°å·å¯èƒ½æœƒè·‘é€²ä¾†ã€‚"
                ]
            },
            { 
                word: "ç„¶è€Œ", 
                meaning: "è¡¨ç¤ºè½‰æŠ˜ï¼Œèªæ°£æ¯”ã€ä½†æ˜¯ã€æ›´ç‚ºæ­£å¼ã€‚", 
                type: "æ­£å¼è½‰æŠ˜",
                examples: [
                    "é€™ä»½ä¼åŠƒæ›¸çš„å…§å®¹å¾ˆè±å¯Œï¼Œ_____åœ¨é ç®—æ–¹é¢ä¼¼ä¹éæ–¼æ¨‚è§€ã€‚",
                    "ä»–è€—è²»äº†è¨±å¤šå¿ƒåŠ›é€²è¡Œç ”ç©¶ï¼Œ_____æœ€çµ‚çš„æˆæœå»ä¸å¦‚é æœŸã€‚",
                    "è¨±å¤šäººè¿½æ±‚ååˆ©ï¼Œ_____é€™äº›ä¸¦ä¸èƒ½å¸¶ä¾†çœŸæ­£çš„å¿«æ¨‚ã€‚"
                ]
            },
            { 
                word: "å€’æ˜¯", 
                meaning: "è¡¨ç¤ºæå‡ºä¸€å€‹èˆ‡çœ¾ä¸åŒæˆ–å‡ºä¹æ„æ–™çš„çœ‹æ³•ï¼Œå¸¶æœ‰è¼•å¾®è½‰æŠ˜æˆ–å¼·èª¿ã€‚", 
                type: "è¼•å¾®è½‰æŠ˜",
                examples: [
                    "ä»–ä¸æœƒèªªæ³•æ–‡ï¼Œè‹±æ–‡_____èªªå¾—å¾ˆæµåˆ©ã€‚",
                    "é€™é“èœçœ‹èµ·ä¾†å¾ˆç°¡å–®ï¼Œåƒèµ·ä¾†_____æŒºç¾å‘³çš„ã€‚",
                    "ä»–ä»Šå¤©çœ‹èµ·ä¾†å¿ƒæƒ…ä¸å¤ªå¥½ï¼Œ_____ä»–å°å·¥ä½œè¡¨ç¾é‚„æ˜¯ä¸€æ¨£èªçœŸã€‚"
                ]
            },
            { 
                word: "ä¸é", 
                meaning: "è¡¨ç¤ºè¼•å¾®è½‰æŠ˜æˆ–è£œå……èªªæ˜ï¼Œèªæ°£è¼ƒã€ä½†æ˜¯ã€ç·©å’Œã€‚", 
                type: "è¼•å¾®è½‰æŠ˜",
                examples: [
                    "é€™å®¶é¤å»³çš„æœå‹™å¾ˆä¸éŒ¯ï¼Œ_____åƒ¹æ ¼ç¨å¾®é«˜äº†ä¸€é»ã€‚",
                    "æˆ‘å°é€™å€‹è¨ˆç•«æ²’æœ‰ç•°è­°ï¼Œ_____æˆ‘å€‘éœ€è¦æ›´å¤šçš„è³‡é‡‘æ”¯æ´ã€‚",
                    "ä»–å·²ç¶“é€šéäº†åˆè©¦ï¼Œ_____è¤‡è©¦çš„é›£åº¦æ›´é«˜ã€‚"
                ]
            },
            { 
                word: "èˆ‡å…¶", 
                meaning: "è¡¨ç¤ºæ¯”è¼ƒé¸æ“‡ï¼Œé€šå¸¸èˆ‡ã€ä¸å¦‚ã€ã€ã€å¯§å¯ã€æ­é…ï¼Œå¼•å°å‡ºæ¯”è¼ƒä¸é¡˜æ„é¸æ“‡çš„ä¸€æ–¹ã€‚", 
                type: "é¸æ“‡",
                examples: [
                    "_____ååœ¨å®¶è£¡ç™¼å‘†ï¼Œä¸å¦‚å‡ºå»èµ°èµ°ï¼Œå‘¼å¸æ–°é®®ç©ºæ°£ã€‚",
                    "_____æŠ±æ€¨ç’°å¢ƒä¸å¥½ï¼Œä¸å¦‚æƒ³æƒ³è‡ªå·±èƒ½åšäº›ä»€éº¼æ”¹è®Šã€‚",
                    "_____ç¾åœ¨å‹‰å¼·æ¥å—ï¼Œä¸å¦‚ä»”ç´°æ€è€ƒå¾Œå†åšæ±ºå®šã€‚"
                ]
            },
            { 
                word: "ä¸¦ä¸”", 
                meaning: "è¡¨ç¤ºä¸¦åˆ—æˆ–é€²ä¸€æ­¥çš„éé€²é—œä¿‚ã€‚", 
                type: "ä¸¦åˆ—éé€²",
                examples: [
                    "ä»–ä¸»å‹•å®Œæˆäº†ä»»å‹™ï¼Œ_____æä¾›äº†å¹¾é …æ”¹é€²å»ºè­°ã€‚",
                    "æˆ‘å€‘éœ€è¦æä¾›è©³ç´°çš„å ±å‘Šï¼Œ_____è¦é™„ä¸Šæ‰€æœ‰ç›¸é—œçš„æ•¸æ“šã€‚",
                    "é€™åº§åŸå¸‚ä¸åƒ…ç’°å¢ƒå„ªç¾ï¼Œ_____æ­·å²æ–‡åŒ–ä¹Ÿååˆ†è±å¯Œã€‚"
                ]
            },
            { 
                word: "åè€Œ", 
                meaning: "è¡¨ç¤ºäº‹ç‰©ç™¼å±•çš„æ–¹å‘èˆ‡é æœŸæˆ–å¸¸ç†ç›¸åã€‚", 
                type: "åå‘è½‰æŠ˜",
                examples: [
                    "åŸæœ¬æƒ³é ç¯€é£Ÿä¾†æ¸›è‚¥ï¼Œæ²’æƒ³åˆ°é«”é‡_____å¢åŠ äº†ã€‚",
                    "ä»–çš„å®‰æ…°æ²’æœ‰è®“å¥¹å¥½éï¼Œ_____è®“å¥¹æ›´é›£éäº†ã€‚",
                    "ä¸‹é›¨å¤©åŸæœ¬ä»¥ç‚ºè·¯ä¸Šè»Šæœƒå°‘ä¸€é»ï¼Œ_____æ¯”å¹³å¸¸æ›´å¡ã€‚"
                ]
            },
            { 
                word: "æ‰€ä»¥", 
                meaning: "è¡¨ç¤ºçµæœæˆ–çµè«–ï¼Œé€šå¸¸æ˜¯å°å‰ä¸€å¥åŸå› çš„ç¸½çµã€‚", 
                type: "å› æœ",
                examples: [
                    "å› ç‚ºä»–æ˜¨å¤©ç†¬å¤œå·¥ä½œï¼Œ_____ä»Šå¤©ç²¾ç¥ä¸å¤ªå¥½ã€‚",
                    "é€™é …ç”¢å“çš„å“è³ªå„ªç•°ï¼Œ_____ç²å¾—äº†å¸‚å ´çš„å»£æ³›èªå¯ã€‚",
                    "æˆ‘å€‘éŒ¯éäº†æœ€å¾Œä¸€ç­å…¬è»Šï¼Œ_____ä¸å¾—ä¸æ­è¨ˆç¨‹è»Šå›å®¶ã€‚"
                ]
            },
            { 
                word: "ä¸è«–", 
                meaning: "è¡¨ç¤ºåœ¨ä»»ä½•æ¢ä»¶æˆ–ç¯„åœå…§ï¼Œçµæœéƒ½ä¸æœƒæ”¹è®Šã€‚", 
                type: "æ¢ä»¶/ç¯„åœ",
                examples: [
                    "_____å¤©æ°£æ™´æœ—æˆ–ä¸‹é›¨ï¼Œæˆ‘éƒ½æœƒæº–æ™‚åƒåŠ é€™å ´æœƒè­°ã€‚",
                    "_____é‡åˆ°å¤šå¤§çš„å›°é›£ï¼Œæˆ‘å€‘éƒ½ä¸èƒ½è¼•è¨€æ”¾æ£„ã€‚",
                    "_____ä½ ä¾†è‡ªå“ªå€‹åœ‹å®¶ï¼Œåœ¨é€™è£¡éƒ½æœƒå—åˆ°å¹³ç­‰çš„å°å¾…ã€‚"
                ]
            }
        ];

        let studyIndex = 0; // å­¸ç¿’æ¨¡å¼ç´¢å¼•
        
        // æ¸¬é©—æ¨¡å¼ç‹€æ…‹è®Šæ•¸
        let totalQuizzes = linkerData.length; 
        let correctAnswers = 0;
        let wrongAnswers = 0;
        let quizOrder = []; 
        let currentQuestionIndex = 0; 

        // --- 2. å­¸ç¿’æ¨¡å¼åŠŸèƒ½ (ç„¡è®Šå‹•) ---

        function populateDropdown() {
            const selector = document.getElementById('linkerSelector');
            if (!selector) return;

            selector.innerHTML = '';
            linkerData.forEach((data, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.innerText = `${data.word} (${data.type})`; 
                selector.appendChild(option);
            });
        }
        
        function jumpToLinker(index) {
            studyIndex = parseInt(index);
            renderStudyCard();
        }

        function renderStudyCard() {
            const data = linkerData[studyIndex];
            document.getElementById('studyWord').innerText = data.word;
            document.getElementById('studyMeaning').innerText = `ã€ç”¨é€”ã€‘${data.meaning}`;
            
            const exampleSentence = data.examples[0];
            const filledExample = exampleSentence.replace("_____", `ã€${data.word}ã€‘`);
            document.getElementById('studyExample').innerText = `ã€ä¾‹å¥ã€‘${filledExample}`;

            document.getElementById('linkerSelector').value = studyIndex;
        }

        function nextLinker() {
            studyIndex = (studyIndex + 1) % linkerData.length;
            renderStudyCard();
        }

        function prevLinker() {
            studyIndex = (studyIndex - 1 + linkerData.length) % linkerData.length;
            renderStudyCard();
        }

        // --- 3. æ¸¬é©—æ¨¡å¼åŠŸèƒ½ (æ–°å¢é€²åº¦æ¢) ---
        
        function updateQuizProgress() {
             const progressDiv = document.getElementById('quizProgress');
             if (currentQuestionIndex < totalQuizzes) {
                 progressDiv.innerText = `ç¬¬ ${currentQuestionIndex + 1} é¡Œ / å…± ${totalQuizzes} é¡Œ`;
             } else {
                 progressDiv.innerText = '';
             }
         }

        function shuffleQuizOrder() {
            quizOrder = Array.from({ length: linkerData.length }, (_, i) => i);
            quizOrder.sort(() => Math.random() - 0.5);
        }

        function switchMode(mode) {
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.container').forEach(con => con.classList.remove('active'));
            
            // é‡ç½®é€²åº¦é¡¯ç¤ºå€å¡Š
            document.getElementById('quizProgress').style.display = 'none';

            if(mode === 'study') {
                document.getElementById('btnStudy').classList.add('active');
                document.getElementById('studyContainer').classList.add('active');
                renderStudyCard();
            } else {
                document.getElementById('btnQuiz').classList.add('active');
                document.getElementById('quizContainer').classList.add('active');
                initQuiz(); 
                document.getElementById('quizProgress').style.display = 'block';
            }
        }
        
        function initQuiz() {
            shuffleQuizOrder();
            currentQuestionIndex = 0;
            correctAnswers = 0;
            wrongAnswers = 0;
            totalQuizzes = linkerData.length; 

            document.getElementById('quizSummary').style.display = 'none';
            document.getElementById('quizContent').style.display = 'block';
            renderQuizQuestion();
            updateQuizProgress(); // åˆå§‹åŒ–é€²åº¦
        }

        function renderQuizQuestion() {
            if (currentQuestionIndex >= totalQuizzes) {
                showQuizSummary();
                return;
            }
            
            const quizIndex = quizOrder[currentQuestionIndex];
            const currentData = linkerData[quizIndex];
            
            const exampleIndex = Math.floor(Math.random() * currentData.examples.length);
            const questionSentence = currentData.examples[exampleIndex];

            document.getElementById('quizQuestion').innerHTML = questionSentence; 
            document.getElementById('quizFeedback').innerText = "";
            
            const optionsDiv = document.getElementById('quizOptions');
            optionsDiv.innerHTML = "";

            let options = [];
            options.push({ text: currentData.word, isCorrect: true }); 

            let wrongLinkers = linkerData
                .filter(data => data.word !== currentData.word)
                .sort(() => Math.random() - 0.5)
                .slice(0, 3); 
            
            wrongLinkers.forEach(linker => {
                options.push({ text: linker.word, isCorrect: false });
            });

            options.sort(() => Math.random() - 0.5);

            options.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = opt.text;
                btn.onclick = function() { checkAnswer(btn, opt.isCorrect, currentData.word) };
                optionsDiv.appendChild(btn);
            });
            
            updateQuizProgress(); // æ›´æ–°é€²åº¦
        }

        function checkAnswer(btn, isCorrect, correctWord) {
            const allBtns = document.querySelectorAll('#quizOptions .option-btn');
            allBtns.forEach(b => b.onclick = null); 

            const questionDiv = document.getElementById('quizQuestion');
            
            if (isCorrect) {
                btn.classList.add('correct');
                questionDiv.innerHTML = questionDiv.innerHTML.replace("_____", `ã€${correctWord}ã€‘`);
                document.getElementById('quizFeedback').innerText = "ğŸ‰ ç­”å°äº†ï¼";
                correctAnswers++; 
            } else {
                btn.classList.add('wrong');
                document.getElementById('quizFeedback').innerText = "âŒ ç­”éŒ¯äº†ï¼è«‹çœ‹æ­£ç¢ºç­”æ¡ˆå¡«å…¥å¾Œçš„å¥å­ã€‚";
                wrongAnswers++; 
                
                questionDiv.innerHTML = questionDiv.innerHTML.replace("_____", `ã€${correctWord}ã€‘`);
                
                allBtns.forEach(b => {
                    if (b.innerText === correctWord && !b.classList.contains('wrong')) {
                         b.classList.add('correct');
                    }
                });
            }
        }

        function nextQuiz() {
            currentQuestionIndex++;
            renderQuizQuestion();
        }

        function showQuizSummary() {
            const summaryDiv = document.getElementById('quizSummary');
            const contentDiv = document.getElementById('quizContent');
            const summaryText = document.getElementById('summaryText');

            document.getElementById('quizProgress').innerText = ''; // æ¸…ç©ºé€²åº¦æ¢

            contentDiv.style.display = 'none';
            summaryDiv.style.display = 'block';
            
            const percentage = totalQuizzes > 0 ? Math.round((correctAnswers / totalQuizzes) * 100) : 0;
            summaryText.innerHTML = `ç­”å° ${correctAnswers} é¡Œï¼Œç­”éŒ¯ ${wrongAnswers} é¡Œã€‚<br>å¾—åˆ†ç‡ï¼š${percentage}%`;
        }

        function startNewQuizRound() {
            initQuiz();
        }


        // --- 4. å•Ÿå‹• ---
        window.onload = function() {
            populateDropdown();
            renderStudyCard();
        };

    </script>
</body>
</html>